<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.pet.Together.Adopt.AdoptMapper">

	<resultMap type="com.pet.Together.Adopt.Adopt" id="Adopt">
		<result property="num" column="num"></result>
		<result property="title" column="title"></result>
		<result property="writer" column="writer"></result>
		<result property="pet_id" column="pet_id"></result>
		<result property="family" column="family"></result>
		<result property="job" column="job"></result>
		<result property="walktime" column="walktime"></result>
		<result property="dating" column="dating"></result>
		<result property="content" column="content"></result>
		<result property="state" column="state"></result>
	</resultMap>

<insert id="addAdopt" parameterType="com.pet.Together.Adopt.Adopt">
	insert into to_adopt 
	values(to_adopt_seq.nextval, #{title}, #{writer}, #{pet_id}, 
			#{family}, #{job}, #{walktime}, #{dating}, #{content}, 0)
</insert>

<select id="getAdopt" resultMap="Adopt" parameterType="int">
	select * from to_adopt
	where num=#{num}
</select>

<select id="getAdopts" resultMap="Adopt">
	select * from to_adopt
	order by num desc
</select>



<!--===============입양신청 DB 페이징 시작===============-->
<!-- 총 게시글 갯수 출력-->
<select id="countAdopt" resultType="int">
	select count(*) from to_adopt
</select>

<!-- 페이징 처리 후 게시글 조회 + pet_state==3 인 조건 추가(서브쿼리 활용). -->
<select id="selectAdopt" resultMap="Adopt">
	select * from(
					select rownum rn, a.* from(
												select * from to_adopt a
                                                    where a.pet_id in (
                                                                        select id from to_pet p
                                                                        where state=3)
												order by num desc
												) a
					)
	where rn between #{start} and #{end}
</select>


<!--===============입양신청 DB 페이징 끝===============-->





</mapper>